<Window x:Class="Recorder.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Recorder"
        mc:Ignorable="d"
        Title="Audio Recorder" Height="450" Width="700" ResizeMode="CanResizeWithGrip"
        x:Name="MainWindowInstance" MinHeight="350" MinWidth="500">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="150"/> <!-- Sidebar -->
            <ColumnDefinition Width="*"/> <!-- Main Content -->
        </Grid.ColumnDefinitions>

        <!-- Sidebar Area (Column 0) - Navigation -->
        <Border Grid.Column="0" Background="#FFE0E0E0" Margin="5">
            <StackPanel Margin="10">
                <RadioButton x:Name="CaptureTabButton" Content="Capturing" GroupName="Navigation"
                             IsChecked="True" Checked="CaptureTabButton_Checked" Style="{StaticResource {x:Type ToggleButton}}"/>
                <RadioButton x:Name="HistoryTabButton" Content="History" GroupName="Navigation" Margin="0,10,0,0"
                             Checked="HistoryTabButton_Checked" Style="{StaticResource {x:Type ToggleButton}}"/>
            </StackPanel>
        </Border>

        <!-- Main Content Area (Column 1) - Capturing View -->
        <Grid x:Name="CapturingViewArea" Grid.Column="1" Margin="5" Visibility="Visible">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Top Controls -->
                <RowDefinition Height="*"/>    <!-- Main List Area -->
                <RowDefinition Height="Auto"/> <!-- Bottom Controls -->
            </Grid.RowDefinitions>

            <!-- Top Controls (Row 0) -->
            <Border Grid.Row="0" Background="#FFF0F0F0" Padding="10" Margin="0,0,0,5">
                <StackPanel Orientation="Vertical">
                    <Label Content="Select Application to Record:" FontWeight="Bold"/>
                    <DockPanel Margin="0,5,0,5">
                        <Button x:Name="RefreshAppsButton" Content="Refresh" DockPanel.Dock="Right" Margin="5,0,0,0" Padding="5,0" Click="RefreshAppsButton_Click"/>
                        <ComboBox x:Name="AppComboBox" VerticalAlignment="Center" SelectionChanged="AppComboBox_SelectionChanged"/>
                    </DockPanel>
                    <CheckBox x:Name="AutoStartCheckBox" Content="Auto record when app plays sound" Margin="0,5,0,5" Checked="AutoStartCheckBox_Checked" Unchecked="AutoStartCheckBox_Unchecked"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                        <Button x:Name="StartButton" Content="Start Recording Selected App" Width="200" Height="30" Margin="0,5,5,5" Click="StartButton_Click"/>
                        <Button x:Name="StopButton" Content="Stop Recording" Width="150" Height="30" Margin="5" Click="StopButton_Click" IsEnabled="False"/>
                    </StackPanel>
                    <!-- Audio Level Visualizer -->
                    <DockPanel Margin="0,10,0,0">
                        <Label Content="Level:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ProgressBar Minimum="0" Maximum="100" Value="{Binding CurrentPeakLevel, FallbackValue=0}" Height="10" VerticalAlignment="Center"/>
                    </DockPanel>
                </StackPanel>
            </Border>

            <!-- Main List Area (Row 1) - ListView for Temporary Recordings -->
            <ListView x:Name="RecordingsListView" Grid.Row="1" ItemsSource="{Binding FinishedRecordings}" Margin="0,0,0,5" BorderBrush="#FFCCCCCC" BorderThickness="1"
                      SelectionChanged="RecordingsListView_SelectionChanged">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="Temporary File Name" DisplayMemberBinding="{Binding FileName}" Width="Auto"/>
                    </GridView>
                </ListView.View>
            </ListView>

            <!-- Bottom Controls (Row 2) -->
             <Border Grid.Row="2" Background="#FFF0F0F0" Padding="10">
                 <DockPanel LastChildFill="False">
                     <!-- Left Side: Save and Format -->
                     <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
                         <Button x:Name="SaveButton" Content="Save Selected Recording..." Width="180" Height="30" Click="SaveButton_Click" IsEnabled="False"/>
                         <Label Content="Format:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                         <ComboBox x:Name="FormatComboBox" VerticalAlignment="Center" Width="70" SelectedIndex="0">
                             <ComboBoxItem Content="MP3"/>
                             <ComboBoxItem Content="WAV"/>
                         </ComboBox>
                     </StackPanel>

                     <!-- Trimming Controls Removed -->

                 </DockPanel>
             </Border>
        </Grid>

        <!-- Main Content Area (Column 1) - History View -->
        <Grid x:Name="HistoryViewArea" Grid.Column="1" Margin="5" Visibility="Collapsed">
             <ListView x:Name="HistoryListView" ItemsSource="{Binding SavedRecordings}" Margin="0,0,0,5" BorderBrush="#FFCCCCCC" BorderThickness="1">
                 <ListView.View>
                     <GridView>
                         <GridViewColumn Header="Saved File Name" DisplayMemberBinding="{Binding FileName}" Width="Auto"/>
                         <!-- TODO: Add columns for path, date, etc. -->
                     </GridView>
                 </ListView.View>
             </ListView>
             <!-- TODO: Add buttons here later to play/delete history items -->
        </Grid>

    </Grid>
</Window>
